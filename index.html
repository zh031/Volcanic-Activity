<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="Guatemala Volcano Safety Association">
<meta name="keywords" content="Guatemala, volcano, safety, earthquakes">
<meta name="author" content="GVSA">
<title>GVSA</title>

<!-- CSS -->
<link rel="stylesheet" href="assets/css/main.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

<style>
    /* Scrollable page container */
    .page-scrollable {
        height: 100vh; /* full viewport */
        overflow-y: auto;
        padding: 2rem;
        box-sizing: border-box;
        scroll-behavior: smooth;
        max-width: 1200px;
        margin: 0 auto;
    }

    /* Section Titles */
    .section-title {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 1.5rem;
        text-align: center;
        color: #333;
        position: sticky;
        top: 0;
        background: #f5f5f5;
        padding: 1rem 0;
        z-index: 5;
    }

    /* DATA CARD STYLING */
    .data-card {
        background: #1e1e1e;
        color: #fff;
        border-radius: 10px;
        padding: 1rem;
        margin: 1rem 0;
        box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    .data-card h4 { margin: 0.5rem 0; font-size: 1.2rem; }
    .data-card p { margin: 0.3rem 0; font-size: 0.9rem; }

    .bar-container { 
        background: #333; 
        border-radius: 5px; 
        height: 10px; 
        margin-top: 0.5rem; 
    }
    .bar-fill { height: 100%; border-radius: 5px; }

    .volcano-high .bar-fill { background: #e74c3c; }
    .volcano-medium .bar-fill { background: #f1c40f; }
    .volcano-low .bar-fill { background: #2ecc71; }

    .eq-low .bar-fill { background: #2ecc71; }
    .eq-medium .bar-fill { background: #f1c40f; }
    .eq-high .bar-fill { background: #e74c3c; }

    /* Optional: make map responsive */
    #map {
        width: 100%;
        height: 500px;
        border-radius: 10px;
    }
</style>
</head>
<body>

<!-- Device Notification -->
<div class="device-notification">
    <a class="device-notification--logo" href="#0">
        <img src="assets/img/logo.png" alt="GVSA Logo">
        <p>GVSA</p>
    </a>
    <p class="device-notification--message">Please orient your device to portrait or use a larger screen.</p>
</div>

<div class="perspective effect-rotate-left">
    <div class="container">
        <div class="outer-nav--return"></div>
        <div id="viewport" class="l-viewport">
            <div class="l-wrapper">
                
                <!-- Header -->
                <header class="header">
                    <a class="header--logo" href="#0">
                        <img src="assets/img/my-logo.png" alt="GVSA Logo">
                        <p>GVSA</p>
                    </a>
                </header>

                <!-- Side Nav -->
                <nav class="l-side-nav">
                    <ul class="side-nav">
                        <li class="is-active"><span>Introduction</span></li>
                        <li><span>Earthquake Activity</span></li>
                        <li><span>Map</span></li>
                        <li><span>Staying Safe</span></li>
                        <li><span>Volcanic Activity</span></li>
                    </ul>
                </nav>

                <!-- Main Content -->
                <ul class="l-main-content main-content">

                    <!-- Introduction -->
                    <li class="l-section section section--is-active">
                        <div class="page-scrollable">
                            <div class="intro page-content">
                                <div class="intro--banner">
                                    <h1>Guatemala <br>Volcano<br>Safety<br>Association</h1>
                                    <img src="assets/img/volcanopng.png" alt="Welcome">
                                </div>
                                <div class="intro--options">
                                    <h2 class="section-title">Emergency Contact List</h2>
                                    <a href="#0">
                                        <h4>Firefighters</h4>
                                        <p>122; contacto@bomberosvoluntarios.org.gt</p>
                                    </a>
                                    <a href="#0">
                                        <h4>First Responders</h4>
                                        <p>123; info@cbm.com.gt</p>
                                    </a>
                                    <a href="#0">
                                        <h4>INSIVUMEH</h4>
                                        <p>+502 2443 4524; real-time volcano monitoring</p>
                                    </a>
                                    <a href="#0">
                                        <h4>CONRED</h4>
                                        <p>119; Coordinating evacuations and emergency response</p>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </li>

                    <!-- Volcanic Activity -->
                    <li class="l-section section">
                        <div class="page-scrollable">
                            <div class="work page-content">
                                <h2 class="section-title">Volcanic Activity</h2>
                                <div id="volcanoContainer">
                                    <h3>Loading volcano data...</h3>
                                </div>
                            </div>
                        </div>
                    </li>

                    <!-- Map -->
                    <li class="l-section section">
                        <div class="page-scrollable">
                            <div class="about page-content">
                                <h2 class="section-title">Volcano and Earthquake Map</h2>
                                <div id="map"></div>
                            </div>
                        </div>
                    </li>

                    <!-- Staying Safe -->
                    <li class="l-section section">
                        <div class="page-scrollable">
                            <div class="work page-content">
                                <h2 class="section-title">Staying Safe</h2>
                                <div class="work--lockup">
                                    <ul class="slider">
                                        <!-- Slider items unchanged -->
                                    </ul>
                                    <div class="slider--prev">...</div>
                                    <div class="slider--next">...</div>
                                </div>
                            </div>
                        </div>
                    </li>

                    <!-- Earthquake Activity -->
                    <li class="l-section section">
                        <div class="page-scrollable">
                            <div class="work page-content">
                                <h2 class="section-title">Recent Earthquake Activity</h2>
                                <div id="earthquakeContainer">
                                    <h3>Loading earthquake data...</h3>
                                </div>
                            </div>
                        </div>
                    </li>

                    <!-- About -->
                    <li class="l-section section">
                        <div class="page-scrollable">
                            <div class="about page-content">
                                <h2 class="section-title">About GVSA</h2>
                                <p>We monitor volcanic activity and earthquakes in Guatemala to help keep citizens safe. All data is provided in real time from INSIVUMEH and USGS APIs.</p>
                            </div>
                        </div>
                    </li>

                </ul>
            </div>
        </div>
    </div>

    <!-- Outer Nav -->
    <ul class="outer-nav">
        <li class="is-active">Introduction</li>
        <li>Earthquake Activity</li>
        <li>Map</li>
        <li>Staying Safe</li>
        <li>Volcanic Activity</li>
    </ul>
</div>

<!-- Scripts -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="assets/js/functions-min.js"></script>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    // MAP SETUP
    var map = L.map('map').setView([15.7835, -90.2308], 7);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    // ICONS
    var greenIcon = new L.Icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png', iconSize: [25,41], iconAnchor:[12,41] });
    var redIcon = new L.Icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png', iconSize: [25,41], iconAnchor:[12,41] });
    var blueIcon = new L.Icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png', iconSize: [25,41], iconAnchor:[12,41] });

    var volcanoes = [
        { name: "Acatenango", coords:[14.5005,-90.8757], icon:redIcon, lastActivity:"2023-07-15" },
        { name: "Agua", coords:[14.4772,-90.7411], icon:greenIcon, lastActivity:"2014-03-01" },
        { name: "Atitlán", coords:[14.6343,-91.1828], icon:greenIcon, lastActivity:"2015-06-20" },
        { name: "Chingo", coords:[13.9382,-89.2962], icon:greenIcon, lastActivity:"1999-04-10" },
        { name: "Fuego", coords:[14.4745,-90.8808], icon:redIcon, lastActivity:"2023-10-28" },
        { name: "Ipala", coords:[14.3667,-89.8061], icon:greenIcon, lastActivity:"2015-01-01" },
        { name: "Pacaya", coords:[14.3819,-90.6016], icon:redIcon, lastActivity:"2023-10-01" },
        { name: "Santa María", coords:[14.7561,-91.5522], icon:redIcon, lastActivity:"2023-09-10" },
        { name: "Santiaguito", coords:[14.748,-91.556], icon:blueIcon, lastActivity:"2023-10-05" },
        { name: "Tacaná", coords:[14.9008,-92.2335], icon:redIcon, lastActivity:"1986-10-13" },
        { name: "Tolimán", coords:[14.6401,-91.1529], icon:greenIcon, lastActivity:"2018-02-15" },
        { name: "Zunil", coords:[14.9333,-91.7333], icon:greenIcon, lastActivity:"2000-01-01" }
    ];

    // ADD MARKERS & CARDS
    volcanoes.forEach(function(v){
        L.marker(v.coords, {icon: v.icon}).addTo(map).bindPopup("<b>"+v.name+"</b><br>Last Activity: "+v.lastActivity);
        var level = v.icon === redIcon ? "volcano-high" : v.icon === blueIcon ? "volcano-medium" : "volcano-low";
        var dangerLevel = level == "volcano-high" ? "High" : level == "volcano-medium" ? "Medium" : "Low";
        var activityPercent = level == "volcano-high" ? 100 : level == "volcano-medium" ? 60 : 30;
        var card = $(`
            <div class="data-card ${level}">
                <h4>${v.name}</h4>
                <p>Coordinates: ${v.coords.join(', ')}</p>
                <p>Last Activity: ${v.lastActivity}</p>
                <p>Danger Level: ${dangerLevel}</p>
                <div class="bar-container">
                    <div class="bar-fill" style="width:${activityPercent}%;"></div>
                </div>
            </div>
        `);
        $('#volcanoContainer').append(card);
    });

    // EARTHQUAKE DATA
    axios.get('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/significant_month.geojson')
    .then(function(response){
        $('#earthquakeContainer').empty();
        response.data.features.forEach(function(eq){
            var props = eq.properties;
            var mag = props.mag;
            var severity = mag < 4 ? "eq-low" : mag < 6 ? "eq-medium" : "eq-high";
            var magPercent = Math.min(mag*20, 100);
            var card = $(`
                <div class="data-card">
                    <h4>Magnitude: <span class="${severity}">${mag}</span></h4>
                    <p>Location: ${props.place}</p>
                    <p>Time: ${new Date(props.time).toLocaleString()}</p>
                    <div class="bar-container">
                        <div class="bar-fill ${severity}" style="width:${magPercent}%;"></div>
                    </div>
                </div>
            `);
            $('#earthquakeContainer').append(card);
        });
    })
    .catch(function(err){
        $('#earthquakeContainer').html('<p>Error loading earthquake data.</p>');
        console.error(err);
    });
</script>
</body>
</html>
